--+ server-message on
-- Verification for CBRD-25472

-- with default value & special character
create or replace function test_func1(a int := 1 comment 'test sp char 123`~!@#$%^&*()_-=+\;,./?:;"[]{}\<>') return varchar
as
begin
    return 'func1 param: ' || a;
end;

select test_func1() from dual;


-- without default value
create or replace function test_func2(a int comment 'param comment without default value') return varchar
as
begin
    test_func1(3);
    return 'func2 param: ' || a;
end;

select test_func2(10) from dual;


-- recursive
create or replace function test_func3(num int comment 'recursive function') return int
as
begin
    if num = 0 then
        return 1;
    else
        return num * test_func3(num-1);
    end if;
end;

select test_func3(5) from dual;


-- maximum test
-- compile error: length over
create or replace function test_func4(num int comment '_0123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890') return varchar
as
begin
    return 'maximum comment length over';
end;
-- maximum length: 1024 byte
create or replace function test_func4(num int comment '0123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890123456768901234567689012345676890') return varchar
as
begin
    return 'maximum comment length';
end;

select test_func4(99) from dual;


select sp_name, arg_name, comment from db_stored_procedure_args where comment is not null order by sp_name;

drop function test_func1;
drop function test_func2;
drop function test_func3;
drop function test_func4;

--+ server-message off